<template include="./view/htm/my.common.template.htm">
    <slot name="my_nav">
        <?php include haya_blog_theme_view('my_nav.inc.htm'); ?>
    </slot>
    
    <slot name="my_body">
        <!--{hook plugin_haya_blog_myarticle_update_start.htm}-->
        
        <div class="haya-blog-article">
            <form action="<?php echo haya_blog_url('myarticle-update');?>" method="post">
                <input type="hidden" name="id" value="<?php echo $id; ?>" style="display: none;">
                
                <!--{hook plugin_haya_blog_myarticle_update_form_before.htm}-->
                
                <div class="form-group row mb-3 mt-2">
                    <label class="col-12 form-control-label pr-0" for="category_id">
                        <span class="text-danger font-weight-bold">*</span>
                        分区：
                    </label>
                    <div class="col-12">
                        <select class="custom-select" name="category_id" id="category_id">
                            <option value="">选择分区</option>
                            <?php foreach ($haya_blog_category as $category) { ?>
                                <?php if ($haya_blog_article['category_id'] == $category['id']) { ?>
                                    <option value="<?php echo $category['id']; ?>" selected="selected"><?php echo $category['title']; ?></option>
                                <?php } else { ?>
                                    <option value="<?php echo $category['id']; ?>"><?php echo $category['title']; ?></option>
                                <?php } ?>
                            <?php } ?>
                        </select>
                        <div class="figure-caption mt-2">
                            选择文章的分区，以便于整站分区查看
                        </div>
                    </div>
                </div>
                <!--{hook plugin_haya_blog_myarticle_update_category_id_after.htm}-->
                
                <div class="form-group row mb-3 mt-4">
                    <label class="col-12 form-control-label pr-0" for="cid">
                        <span class="text-danger font-weight-bold">*</span>
                        文章分类：
                    </label>
                    <div class="col-12">
                        <select class="custom-select" name="cid" id="cid">
                            <option value="">选择文章分类</option>
                            <?php foreach ($haya_blog_author_category as $author_category) { ?>
                                <?php if ($haya_blog_article['category_id'] == $category['id']) { ?>
                                    <option value="<?php echo $author_category['id']; ?>" selected="selected"><?php echo $author_category['title']; ?></option>
                                <?php } else { ?>
                                    <option value="<?php echo $author_category['id']; ?>"><?php echo $author_category['title']; ?></option>
                                <?php } ?>
                            <?php } ?>
                        </select>
                        <div class="figure-caption mt-2">
                            选择我设置的文章分类
                        </div>
                    </div>
                </div>
                <!--{hook plugin_haya_blog_myarticle_update_cid_after.htm}-->
                
                <div class="form-group row mb-3 mt-4">
                    <label class="col-12 form-control-label pr-0" for="title">
                        <span class="text-danger font-weight-bold">*</span>
                        标题：
                    </label>
                    <div class="col-12">
                        <input type="text" name="title" id="title" value="<?php echo $haya_blog_article['title']; ?>" placeholder="填写文章标题" class="form-control">
                        <div class="figure-caption mt-2">
                            设置文章标题，不能为空
                        </div>
                    </div>
                </div>
                <!--{hook plugin_haya_blog_myarticle_update_title_after.htm}-->
                
                <div class="form-group row mb-3 mt-4">
                    <label class="col-12 form-control-label pr-0" for="content">
                        <span class="text-danger font-weight-bold">*</span>
                        内容：
                    </label>
                    <div class="col-12">
                        <textarea class="form-control" style="height: 200px;" placeholder="填写文章内容" name="content" id="content"><?php echo $haya_blog_article['content']; ?></textarea>
                        <div class="figure-caption mt-2">
                            设置填写文章内容
                        </div>
                    </div>
                </div>
                <!--{hook plugin_haya_blog_myarticle_update_content_after.htm}-->
                
                <div class="form-group row mb-3 mt-4">
                    <label class="col-12 form-control-label pr-0" for="keywords">
                        关键字：
                    </label>
                    <div class="col-12">
                        <input type="text" name="keywords" id="keywords" value="<?php echo $haya_blog_article['keywords']; ?>" placeholder="填写文章关键字" class="form-control">
                        <div class="figure-caption mt-2">
                            设置文章关键字，以半角逗号隔开
                        </div>
                    </div>
                </div>
                <!--{hook plugin_haya_blog_myarticle_update_keywords_after.htm}-->
                
                <div class="form-group row mb-3 mt-4">
                    <label class="col-12 form-control-label pr-0" for="description">
                        描述：
                    </label>
                    <div class="col-12">
                        <textarea class="form-control" style="height: 100px;" placeholder="填写文章的描述" name="description" id="description"><?php echo $haya_blog_article['description']; ?></textarea>
                        <div class="figure-caption mt-2">
                            设置文章相关描述
                        </div>
                    </div>
                </div>
                <!--{hook plugin_haya_blog_myarticle_update_description_after.htm}-->
                
                <div class="form-group row haya-blog-is-reprinted">
                    <div class="col-12">
                        <label class="form-control-label font-weight-bold text-dark" for="is_reprinted">
                            转载：
                        </label>
                        
                        <span id="is_reprinted">
                            <?php if ($haya_blog_article['is_reprinted'] == 1) { ?>
                                <label class="custom-input custom-radio mr-3">
                                    <input type="radio" name="is_reprinted" value="1" checked="checked"> 转载
                                </label>
                                <label class="custom-input custom-radio mr-3">
                                    <input type="radio" name="is_reprinted" value="0"> 原创
                                </label>
                            <?php } else { ?>
                                <label class="custom-input custom-radio mr-3">
                                    <input type="radio" name="is_reprinted" value="1"> 转载
                                </label>
                                <label class="custom-input custom-radio mr-3">
                                    <input type="radio" name="is_reprinted" value="0" checked="checked"> 原创
                                </label>
                            <?php } ?>
                        </span>
                    </div>
                    
                    <div class="col-12">
                        <div class="figure-caption mt-2">
                            设置文章的转载状态
                        </div>
                    </div>
                </div>
                <!--{hook plugin_haya_blog_myarticle_update_reprinted_after.htm}-->
                
                <div class="form-group row mb-3 mt-4 haya-blog-reprinted-from d-none">
                    <label class="col-12 form-control-label" for="reprinted_from">
                        转载来源：
                    </label>
                    <div class="col-12">
                        <input type="text" name="reprinted_from" id="reprinted_from" value="<?php echo $haya_blog_article['reprinted_from']; ?>" placeholder="填写文章的转载来源" class="form-control">
                        <div class="figure-caption mt-2">
                            设置文章的转载来源
                        </div>
                    </div>
                </div>
                
                <!--{hook plugin_haya_blog_myarticle_update_reprinted_from_after.htm}-->
                
                <div class="form-group row">
                    <div class="col-12">
                        <label class="form-control-label font-weight-bold text-dark" for="is_private">
                            私有：
                        </label>
                    
                        <span id="is_private">
                            <?php if ($haya_blog_article['is_private'] == 1) { ?>
                                <label class="custom-input custom-radio mr-3">
                                    <input type="radio" name="is_private" value="1" checked="checked"> <?php echo lang('enable'); ?>
                                </label>
                                <label class="custom-input custom-radio mr-3">
                                    <input type="radio" name="is_private" value="0"> <?php echo lang('disable'); ?>
                                </label>
                            <?php } else { ?>
                                <label class="custom-input custom-radio mr-3">
                                    <input type="radio" name="is_private" value="1"> <?php echo lang('enable'); ?>
                                </label>
                                <label class="custom-input custom-radio mr-3">
                                    <input type="radio" name="is_private" value="0" checked="checked"> <?php echo lang('disable'); ?>
                                </label>
                            <?php } ?>
                        </span>
                    </div>
                    
                    <div class="col-12">
                        <div class="figure-caption mt-2">
                            设置文章的私有状态
                        </div>
                    </div>
                </div>
                
                <!--{hook plugin_haya_blog_myarticle_update_private_after.htm}-->
                
                <div class="form-group row">
                    <div class="col-12">
                        <label class="form-control-label font-weight-bold text-dark" for="is_reply">
                            允许评论：
                        </label>
                    
                        <span id="is_reply">
                            <?php if ($haya_blog_article['is_reply'] == 1) { ?>
                                <label class="custom-input custom-radio mr-3">
                                    <input type="radio" name="is_reply" value="1" checked="checked"> <?php echo lang('enable'); ?>
                                </label>
                                <label class="custom-input custom-radio mr-3">
                                    <input type="radio" name="is_reply" value="0"> <?php echo lang('disable'); ?>
                                </label>
                            <?php } else { ?>
                                <label class="custom-input custom-radio mr-3">
                                    <input type="radio" name="is_reply" value="1"> <?php echo lang('enable'); ?>
                                </label>
                                <label class="custom-input custom-radio mr-3">
                                    <input type="radio" name="is_reply" value="0" checked="checked"> <?php echo lang('disable'); ?>
                                </label>
                            <?php } ?>
                        </span>
                    </div>
                    
                    <div class="col-12">
                        <div class="figure-caption mt-2">
                            设置文章是否可以评论
                        </div>
                    </div>
                </div>
                
                <!--{hook plugin_haya_blog_myarticle_update_reply_after.htm}-->
                
                <div class="form-group row haya-blog-is-top">
                    <div class="col-12">
                        <label class="form-control-label font-weight-bold text-dark" for="is_top">
                            置顶：
                        </label>
                    
                        <span id="is_top">
                            <?php if ($haya_blog_article['is_author_top'] == 1) { ?>
                                <label class="custom-input custom-radio mr-3">
                                    <input type="radio" name="is_top" value="1" checked="checked"> 启用
                                </label>
                                <label class="custom-input custom-radio mr-3">
                                    <input type="radio" name="is_top" value="0"> 禁用
                                </label>
                            <?php } else { ?>
                                <label class="custom-input custom-radio mr-3">
                                    <input type="radio" name="is_top" value="1"> 启用
                                </label>
                                <label class="custom-input custom-radio mr-3">
                                    <input type="radio" name="is_top" value="0" checked="checked"> 禁用
                                </label>
                            <?php } ?>
                        </span>
                    </div>
                    
                    <div class="col-12">
                        <div class="figure-caption mt-2">
                            设置文章的置顶状态
                        </div>
                    </div>
                </div>
                
                <!--{hook plugin_haya_blog_myarticle_update_top_after.htm}-->
                
                <div class="form-group row mb-3">
                    <div class="col-md-3">
                        <button type="submit" class="btn btn-primary btn-block mr-2 mb-2" id="submit"><?php echo lang('save'); ?></button>
                    </div>
                    <div class="col-md-3">
                        <a role="button" class="btn btn-secondary btn-block mb-2" href="javascript:history.back();"><?php echo lang('back'); ?></a>
                    </div>
                </div>
                
            </form>
        </div>
        
        <!--{hook plugin_haya_blog_myarticle_update_end.htm}-->
    </slot>
</template>

<script>
/** 转载检测 */
function haya_blog_article_is_reprinted() {
    var val = $('.haya-blog-is-reprinted input[name="is_reprinted"]:checked').val();
    if (val == 1) {
        $('.haya-blog-reprinted-from').removeClass('d-none');
    } else {
        $('.haya-blog-reprinted-from').addClass('d-none');
    }
}

$(function() {
    $('a[data-active="menu-haya-blog"]').addClass('active');
    $('a[data-active="my-haya-blog-article"]').addClass('active');
    
    haya_blog_article_is_reprinted();
    $('.haya-blog-is-reprinted input[name="is_reprinted"]').click(function() {
        haya_blog_article_is_reprinted();
    });
});
</script>

<!--{hook plugin_haya_blog_myarticle_update_js.htm}-->
